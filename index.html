<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link data-trunk rel="copy-dir" href="assets" />
    <link data-trunk rel="inline" href="build/web/styles.css" />
</head>

<body>
    <link data-trunk rel="inline" href="build/web/sound.js" />
    <div id="wrapper">
        <div id="container">
            <button id="fullscreen"><img style="width:100%;height:100%;display:block;"
                    src="assets/fullscreen.svg"></button>
        </div>
    </div>

    <script>
        let container = document.querySelector("#container");
        let wrapper = document.querySelector("#wrapper");
        let canvas;

        let canvasWidth;
        let canvasHeight;

        document.querySelector('#fullscreen').addEventListener('click', requestFullScreen, false);

        function requestFullScreen() {
            if (!document.fullscreenElement) {

                if (canvasWidth > canvasHeight) {
                    window.screen.orientation.lock('landscape').catch(e => console.log(e)).finally(() => {
                        canvas.requestFullscreen();
                    });
                } else {
                    window.screen.orientation.lock('portrait').catch(e => console.log(e)).finally(() => {
                        canvas.requestFullscreen();
                    });
                }
            }
        }

        window.addEventListener('load', function () {
            const interval = setInterval(() => {
                canvas = document.querySelector("canvas");

                if (canvas) {
                    clearInterval(interval);
                    canvas.onselectstart = () => {
                        return false;
                    };

                    canvasWidth = canvas.getAttribute('width');
                    canvasHeight = canvas.getAttribute('height');

                    // canvas.addEventListener('fullscreenchange', event => {
                    //     console.log("changed")
                    //     if (!document.fullscreenElement) {
                    //         console.log("resizing")
                    //         canvas.setAttribute('width', canvasWidth);
                    //         canvas.setAttribute('height', canvasHeight);
                    //     }
                    // });

                    // screen.orientation.addEventListener('change', event => {
                    //     console.log(event)
                    //     if (document.fullscreenElement) {
                    //         console.log("resizing")
                    //         canvas.setAttribute('width', window.innerWidth);
                    //         canvas.setAttribute('height', window.innerHeight);
                    //     }
                    // });

                    container.style.maxWidth = canvasWidth + 'px';
                    container.style.maxHeight = canvasHeight + 'px';

                    container.appendChild(canvas);
                    canvas.style.display = 'block';
                    wrapper.style.display = 'block';
                }
            }, 50)
        }, false);
    </script>
</body>

</html>